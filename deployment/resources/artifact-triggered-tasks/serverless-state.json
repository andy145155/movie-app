{
  "service": {
    "service": "movie-app-triggered-tasks",
    "serviceObject": {
      "name": "movie-app-triggered-tasks"
    },
    "provider": {
      "name": "aws",
      "region": "ap-southeast-1",
      "architecture": "arm64",
      "runtime": "python3.11",
      "timeout": 300,
      "deploymentBucket": "movie-app-serverless-bucket",
      "iam": {
        "role": "arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole"
      },
      "iamRoleStatements": [
        {
          "Effect": "Allow",
          "Action": [
            "iam:PassRole"
          ],
          "Resource": {
            "Fn::Join": [
              "",
              [
                "arn:aws:iam::",
                {
                  "Ref": "AWS::AccountId"
                },
                ":role/ecsTaskExecutionRole"
              ]
            ]
          }
        }
      ],
      "stage": "dev",
      "versionFunctions": true,
      "deploymentBucketObject": {
        "name": "movie-app-serverless-bucket",
        "maxPreviousDeploymentArtifacts": 3,
        "blockPublicAccess": true,
        "serverSideEncryption": "AES256"
      },
      "compiledCloudFormationTemplate": {
        "AWSTemplateFormatVersion": "2010-09-09",
        "Description": "The AWS CloudFormation template for this Serverless application",
        "Resources": {
          "TriggerFargateLogGroup": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
              "LogGroupName": "/aws/lambda/movie-app-triggered-tasks-dev-triggerFargate"
            }
          },
          "CsvToS3DatabaseLogGroup": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
              "LogGroupName": "/aws/lambda/movie-app-triggered-tasks-dev-csvToS3Database"
            }
          },
          "MovieAppTriggeredTaskLambdaLayer": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
              "Content": {
                "S3Bucket": "movie-app-serverless-bucket",
                "S3Key": "serverless/movie-app-triggered-tasks/dev/1718985282060-2024-06-21T15:54:42.060Z/MovieAppTriggeredTask.zip"
              },
              "LayerName": "movie-app-triggered-tasks-layer",
              "CompatibleRuntimes": [
                "python3.11"
              ]
            }
          },
          "TriggerFargateLambdaFunction": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
              "Code": {
                "S3Bucket": "movie-app-serverless-bucket",
                "S3Key": "serverless/movie-app-triggered-tasks/dev/1718985282060-2024-06-21T15:54:42.060Z/movie-app-triggered-tasks.zip"
              },
              "Handler": "functions/triggerFargate.handler",
              "Runtime": "python3.11",
              "FunctionName": "movie-app-triggered-tasks-dev-triggerFargate",
              "MemorySize": 1024,
              "Timeout": 300,
              "Architectures": [
                "arm64"
              ],
              "Environment": {
                "Variables": {
                  "SUBNET_A_ID": "subnet-069ee4c1a5955765d",
                  "SUBNET_B_ID": "subnet-0ce7bc386fe60d549",
                  "FARGATE_SG_ID": "sg-01156858c7871ec6c",
                  "MOVIE_APP_ESC_CLUSTER_ARN": "arn:aws:ecs:ap-southeast-1:410370150231:cluster/movie-app-fargate-dev-FargateTasksCluster-sLoYFCjpH417",
                  "MOVIES_SIMILARITY_DYNAMO_DB_NAME": "movie-similarity",
                  "DATA_PROCESSING_TASK_DEFINITION_ARN": "arn:aws:ecs:ap-southeast-1:410370150231:task-definition/dataProcessing",
                  "MOVE_CSV_PROCESSED_BUCKET_NAME": "movie-app-csv-processed-bucket",
                  "MOVE_CSV_SOURCE_BUCKET_NAME": "movie-app-csv-source-bucket"
                }
              },
              "Role": "arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",
              "Layers": [
                {
                  "Ref": "MovieAppTriggeredTaskLambdaLayer"
                }
              ]
            },
            "DependsOn": [
              "TriggerFargateLogGroup"
            ]
          },
          "CsvToS3DatabaseLambdaFunction": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
              "Code": {
                "S3Bucket": "movie-app-serverless-bucket",
                "S3Key": "serverless/movie-app-triggered-tasks/dev/1718985282060-2024-06-21T15:54:42.060Z/movie-app-triggered-tasks.zip"
              },
              "Handler": "functions/csvToS3Database.handler",
              "Runtime": "python3.11",
              "FunctionName": "movie-app-triggered-tasks-dev-csvToS3Database",
              "MemorySize": 1024,
              "Timeout": 300,
              "Architectures": [
                "arm64"
              ],
              "Environment": {
                "Variables": {
                  "MOVE_CSV_PROCESSED_BUCKET_NAME": "movie-app-csv-processed-bucket"
                }
              },
              "Role": "arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",
              "Layers": [
                {
                  "Ref": "MovieAppTriggeredTaskLambdaLayer"
                }
              ]
            },
            "DependsOn": [
              "CsvToS3DatabaseLogGroup"
            ]
          },
          "TriggerFargateLambdaVersionLXXjVtIIZysJJT8hnUNCGJgO8JGn9b4eU48SqBo90": {
            "Type": "AWS::Lambda::Version",
            "DeletionPolicy": "Retain",
            "Properties": {
              "FunctionName": {
                "Ref": "TriggerFargateLambdaFunction"
              },
              "CodeSha256": "0ejNfJ4MqbiTtA8s0ufAuHLtr6r4Y84Q2yBfip9iLuc="
            }
          },
          "CsvToS3DatabaseLambdaVersionpQL1IU5b5iROGLJpjkKmw17SC8yQ7X7Aw3LNjwoNPfY": {
            "Type": "AWS::Lambda::Version",
            "DeletionPolicy": "Retain",
            "Properties": {
              "FunctionName": {
                "Ref": "CsvToS3DatabaseLambdaFunction"
              },
              "CodeSha256": "0ejNfJ4MqbiTtA8s0ufAuHLtr6r4Y84Q2yBfip9iLuc="
            }
          },
          "TriggerFargateSnsSubscriptionMovieapps3triggeredevent": {
            "Type": "AWS::SNS::Subscription",
            "Properties": {
              "TopicArn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",
              "Protocol": "lambda",
              "Endpoint": {
                "Fn::GetAtt": [
                  "TriggerFargateLambdaFunction",
                  "Arn"
                ]
              }
            }
          },
          "TriggerFargateLambdaPermissionMovieapps3triggeredeventSNS": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
              "FunctionName": {
                "Fn::GetAtt": [
                  "TriggerFargateLambdaFunction",
                  "Arn"
                ]
              },
              "Action": "lambda:InvokeFunction",
              "Principal": "sns.amazonaws.com",
              "SourceArn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event"
            }
          },
          "CsvToS3DatabaseSnsSubscriptionMovieapps3triggeredevent": {
            "Type": "AWS::SNS::Subscription",
            "Properties": {
              "TopicArn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",
              "Protocol": "lambda",
              "Endpoint": {
                "Fn::GetAtt": [
                  "CsvToS3DatabaseLambdaFunction",
                  "Arn"
                ]
              }
            }
          },
          "CsvToS3DatabaseLambdaPermissionMovieapps3triggeredeventSNS": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
              "FunctionName": {
                "Fn::GetAtt": [
                  "CsvToS3DatabaseLambdaFunction",
                  "Arn"
                ]
              },
              "Action": "lambda:InvokeFunction",
              "Principal": "sns.amazonaws.com",
              "SourceArn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event"
            }
          }
        },
        "Outputs": {
          "ServerlessDeploymentBucketName": {
            "Value": "movie-app-serverless-bucket",
            "Export": {
              "Name": "sls-movie-app-triggered-tasks-dev-ServerlessDeploymentBucketName"
            }
          },
          "MovieAppTriggeredTaskLambdaLayerQualifiedArn": {
            "Description": "Current Lambda layer version",
            "Value": {
              "Ref": "MovieAppTriggeredTaskLambdaLayer"
            },
            "Export": {
              "Name": "sls-movie-app-triggered-tasks-dev-MovieAppTriggeredTaskLambdaLayerQualifiedArn"
            }
          },
          "MovieAppTriggeredTaskLambdaLayerHash": {
            "Description": "Current Lambda layer hash",
            "Value": "758aea6f647e179a088cbed8df3500c702ae3c90",
            "Export": {
              "Name": "sls-movie-app-triggered-tasks-dev-MovieAppTriggeredTaskLambdaLayerHash"
            }
          },
          "MovieAppTriggeredTaskLambdaLayerS3Key": {
            "Description": "Current Lambda layer S3Key",
            "Value": "serverless/movie-app-triggered-tasks/dev/1718985282060-2024-06-21T15:54:42.060Z/MovieAppTriggeredTask.zip",
            "Export": {
              "Name": "sls-movie-app-triggered-tasks-dev-MovieAppTriggeredTaskLambdaLayerS3Key"
            }
          },
          "TriggerFargateLambdaFunctionQualifiedArn": {
            "Description": "Current Lambda function version",
            "Value": {
              "Ref": "TriggerFargateLambdaVersionLXXjVtIIZysJJT8hnUNCGJgO8JGn9b4eU48SqBo90"
            },
            "Export": {
              "Name": "sls-movie-app-triggered-tasks-dev-TriggerFargateLambdaFunctionQualifiedArn"
            }
          },
          "CsvToS3DatabaseLambdaFunctionQualifiedArn": {
            "Description": "Current Lambda function version",
            "Value": {
              "Ref": "CsvToS3DatabaseLambdaVersionpQL1IU5b5iROGLJpjkKmw17SC8yQ7X7Aw3LNjwoNPfY"
            },
            "Export": {
              "Name": "sls-movie-app-triggered-tasks-dev-CsvToS3DatabaseLambdaFunctionQualifiedArn"
            }
          }
        }
      },
      "vpc": {}
    },
    "custom": {
      "app_name": "movie-app",
      "service_name": "triggered-tasks",
      "tf": {
        "fargate_security_group_id": "sg-01156858c7871ec6c",
        "fargate_task_role_arn": "arn:aws:iam::410370150231:role/movie-app-FargateTaskRole",
        "lambda_iam_role_arn": "arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",
        "lambda_security_group_id": "sg-0735c702b1cd455e6",
        "movie_app_bucket_www_name": "www.movieapp.paohenghsu.com",
        "movie_app_glue_crawlers_name": {
          "credits": "credits-csv",
          "movies": "movies-csv",
          "similarity": "similarity-csv"
        },
        "movie_app_sns_arn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",
        "movie_app_user_pool_arn": "arn:aws:cognito-idp:ap-southeast-1:410370150231:userpool/ap-southeast-1_yz7eb44ia",
        "movie_app_user_pool_client_id": "4t3f1n3ptj21omm15kd3jjastn",
        "movie_app_user_pool_id": "ap-southeast-1_yz7eb44ia",
        "movie_app_www_distribution_id": "E14SG1HHD3N65C",
        "movie_csv_processed_bucket_name": "movie-app-csv-processed-bucket",
        "movie_csv_source_bucket_name": "movie-app-csv-source-bucket",
        "movie_serverless_bucket_name": "movie-app-serverless-bucket",
        "movie_similarity_table_name": "movie-similarity",
        "movie_user_selection_name": "user-selection",
        "public_subnets": [
          "subnet-069ee4c1a5955765d",
          "subnet-0ce7bc386fe60d549"
        ]
      },
      "fargate_service": {
        "DataProcessingServiceArn": "arn:aws:ecs:ap-southeast-1:410370150231:service/movie-app-fargate-dev-FargateTasksCluster-sLoYFCjpH417/dataProcessing",
        "DataProcessingTaskDefinitionArn": "arn:aws:ecs:ap-southeast-1:410370150231:task-definition/dataProcessing",
        "DataProcessingTaskArn": "arn:aws:ecs:ap-southeast-1:410370150231:task-definition/dataProcessing:71",
        "FargateClusterArn": "arn:aws:ecs:ap-southeast-1:410370150231:cluster/movie-app-fargate-dev-FargateTasksCluster-sLoYFCjpH417",
        "ServerlessDeploymentBucketName": "movie-app-serverless-bucket"
      },
      "FARGATE_SG_ID": "sg-01156858c7871ec6c",
      "DEFAULT_LAMBDA_ROLE_ARN": "arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",
      "ESC_CLUSTER_ARN": "arn:aws:ecs:ap-southeast-1:410370150231:cluster/movie-app-fargate-dev-FargateTasksCluster-sLoYFCjpH417",
      "DATA_PROCESSING_TASK_DEFINITION_ARN": "arn:aws:ecs:ap-southeast-1:410370150231:task-definition/dataProcessing",
      "MOVIES_SIMILARITY_DYNAMO_DB_NAME": "movie-similarity",
      "SNS_TOPIC_ARN": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",
      "MOVE_CSV_PROCESSED_BUCKET_NAME": "movie-app-csv-processed-bucket",
      "MOVE_CSV_SOURCE_BUCKET_NAME": "movie-app-csv-source-bucket",
      "SERVERLESS_BUCKET_NAME": "movie-app-serverless-bucket",
      "SUBNET_A_ID": "subnet-069ee4c1a5955765d",
      "SUBNET_B_ID": "subnet-0ce7bc386fe60d549",
      "GLUE_CRAWLER_CREDITS": "credits-csv",
      "GLUE_CRAWLER_MOVIES": "movies-csv",
      "GLUE_CRAWLER_SIMILARITY": "similarity-csv",
      "output": {
        "handler": "scripts/output.handler",
        "file_path": "../../deployment/resources/sls.triggered-tasks.json"
      }
    },
    "pluginsData": {},
    "functions": {
      "triggerFargate": {
        "handler": "functions/triggerFargate.handler",
        "layers": {
          "$ref": "$[\"service\"][\"provider\"][\"compiledCloudFormationTemplate\"][\"Resources\"][\"TriggerFargateLambdaFunction\"][\"Properties\"][\"Layers\"]"
        },
        "events": [
          {
            "sns": {
              "arn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event"
            }
          }
        ],
        "environment": {
          "SUBNET_A_ID": "subnet-069ee4c1a5955765d",
          "SUBNET_B_ID": "subnet-0ce7bc386fe60d549",
          "FARGATE_SG_ID": "sg-01156858c7871ec6c",
          "MOVIE_APP_ESC_CLUSTER_ARN": "arn:aws:ecs:ap-southeast-1:410370150231:cluster/movie-app-fargate-dev-FargateTasksCluster-sLoYFCjpH417",
          "MOVIES_SIMILARITY_DYNAMO_DB_NAME": "movie-similarity",
          "DATA_PROCESSING_TASK_DEFINITION_ARN": "arn:aws:ecs:ap-southeast-1:410370150231:task-definition/dataProcessing",
          "MOVE_CSV_PROCESSED_BUCKET_NAME": "movie-app-csv-processed-bucket",
          "MOVE_CSV_SOURCE_BUCKET_NAME": "movie-app-csv-source-bucket"
        },
        "name": "movie-app-triggered-tasks-dev-triggerFargate",
        "package": {},
        "memory": 1024,
        "timeout": 300,
        "runtime": "python3.11",
        "vpc": {},
        "versionLogicalId": "TriggerFargateLambdaVersionLXXjVtIIZysJJT8hnUNCGJgO8JGn9b4eU48SqBo90"
      },
      "csvToS3Database": {
        "handler": "functions/csvToS3Database.handler",
        "layers": {
          "$ref": "$[\"service\"][\"provider\"][\"compiledCloudFormationTemplate\"][\"Resources\"][\"CsvToS3DatabaseLambdaFunction\"][\"Properties\"][\"Layers\"]"
        },
        "events": [
          {
            "sns": {
              "arn": "arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event"
            }
          }
        ],
        "environment": {
          "MOVE_CSV_PROCESSED_BUCKET_NAME": "movie-app-csv-processed-bucket"
        },
        "name": "movie-app-triggered-tasks-dev-csvToS3Database",
        "package": {},
        "memory": 1024,
        "timeout": 300,
        "runtime": "python3.11",
        "vpc": {},
        "versionLogicalId": "CsvToS3DatabaseLambdaVersionpQL1IU5b5iROGLJpjkKmw17SC8yQ7X7Aw3LNjwoNPfY"
      }
    },
    "configValidationMode": "warn",
    "serviceFilename": "serverless.yml",
    "initialServerlessConfig": {
      "service": "movie-app-triggered-tasks",
      "frameworkVersion": "3",
      "package": {
        "patterns": [
          "!requirements.txt",
          "!sample/**",
          "!scripts/**",
          "!openapi.yml",
          "../utils/**"
        ],
        "artifactsS3KeyDirname": "serverless/movie-app-triggered-tasks/dev/code-artifacts",
        "deploymentBucket": "movie-app-serverless-bucket",
        "artifact": "/home/runner/work/movie-app/movie-app/backend/triggered-tasks/.serverless/movie-app-triggered-tasks.zip",
        "artifactDirectoryName": "serverless/movie-app-triggered-tasks/dev/1718985282060-2024-06-21T15:54:42.060Z"
      },
      "custom": {
        "$ref": "$[\"service\"][\"custom\"]"
      },
      "provider": {
        "$ref": "$[\"service\"][\"provider\"]"
      },
      "layers": {
        "MovieAppTriggeredTask": {
          "path": "layers",
          "name": "movie-app-triggered-tasks-layer",
          "compatibleRuntimes": {
            "$ref": "$[\"service\"][\"provider\"][\"compiledCloudFormationTemplate\"][\"Resources\"][\"MovieAppTriggeredTaskLambdaLayer\"][\"Properties\"][\"CompatibleRuntimes\"]"
          },
          "package": {
            "artifact": "/home/runner/work/movie-app/movie-app/backend/triggered-tasks/.serverless/MovieAppTriggeredTask.zip"
          }
        }
      },
      "functions": {
        "$ref": "$[\"service\"][\"functions\"]"
      }
    },
    "layers": {
      "$ref": "$[\"service\"][\"initialServerlessConfig\"][\"layers\"]"
    },
    "isDashboardMonitoringPreconfigured": false,
    "artifact": "/home/runner/work/movie-app/movie-app/backend/triggered-tasks/.serverless/movie-app-triggered-tasks.zip"
  },
  "package": {
    "artifactDirectoryName": "serverless/movie-app-triggered-tasks/dev/1718985282060-2024-06-21T15:54:42.060Z",
    "artifact": "movie-app-triggered-tasks.zip"
  }
}
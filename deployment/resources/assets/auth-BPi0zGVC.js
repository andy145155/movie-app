import{a as W,A as v,c as bn,g as An,j as Nn,b as Re,e as Pn,p as me,h as rt,i as Un,k as vt,H as de,l as le,m as Ce,C as De,n as lo}from"./index-CXhrj9mw.js";import{h as Fn}from"./index-CTP4-05Q.js";var be;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown"})(be||(be={}));const Dn=(e,t=W)=>(n,o,i)=>{const{message:s,recoverySuggestion:r}=e[o];if(!n)throw new t({name:o,message:i?`${s} ${i}`:s,recoverySuggestion:r})},fo=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new W({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},po=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new W({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},ho=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new W({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},Mn={convert(e){return ho()(e)}};var P;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(P||(P={}));const mo={[P.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[P.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[P.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[P.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[P.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},at=Dn(mo);function I(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,at(t,P.AuthUserPoolException)}function On(e){var n,o,i,s,r,a,c,u;const t=!!((o=(n=e==null?void 0:e.loginWith)==null?void 0:n.oauth)!=null&&o.domain)&&!!((s=(i=e==null?void 0:e.loginWith)==null?void 0:i.oauth)!=null&&s.redirectSignOut)&&!!((a=(r=e==null?void 0:e.loginWith)==null?void 0:r.oauth)!=null&&a.redirectSignIn)&&!!((u=(c=e==null?void 0:e.loginWith)==null?void 0:c.oauth)!=null&&u.responseType);at(t,P.OAuthNotConfigureException)}function we(e){const t=!!(e!=null&&e.identityPoolId);at(t,P.InvalidIdentityPoolIdException)}function j(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const o=t[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(Mn.convert(o).split("").map(r=>`%${`00${r.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),s=JSON.parse(i);return{toString:()=>e,payload:s}}catch{throw new Error("Invalid token payload")}}var S;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(S||(S={}));var Ze;(function(e){e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(Ze||(Ze={}));var wt;(function(e){e.Record="1",e.IdentifyUser="2"})(wt||(wt={}));var _t;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(_t||(_t={}));var U;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36"})(U||(U={}));var xt;(function(e){e.Subscribe="1",e.GraphQl="2"})(xt||(xt={}));var Tt;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(Tt||(Tt={}));var Rt;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(Rt||(Rt={}));var Ct;(function(e){e.None="0"})(Ct||(Ct={}));var bt;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(bt||(bt={}));var At;(function(e){e.Subscribe="1"})(At||(At={}));var Nt;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(Nt||(Nt={}));var Pt;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7"})(Pt||(Pt={}));const Me=()=>typeof global<"u",Z=()=>typeof window<"u",kn=()=>typeof document<"u",ct=()=>typeof process<"u",fe=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));var Ut={TERRAFORM_ENV:{fargate_security_group_id:"sg-01156858c7871ec6c",fargate_task_role_arn:"arn:aws:iam::410370150231:role/movie-app-FargateTaskRole",lambda_iam_role_arn:"arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",lambda_security_group_id:"sg-0735c702b1cd455e6",movie_app_bucket_www_name:"www.movieapp.paohenghsu.com",movie_app_glue_crawlers_name:{credits:"credits-csv",movies:"movies-csv",similarity:"similarity-csv"},movie_app_sns_arn:"arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",movie_app_user_pool_arn:"arn:aws:cognito-idp:ap-southeast-1:410370150231:userpool/ap-southeast-1_yz7eb44ia",movie_app_user_pool_client_id:"4t3f1n3ptj21omm15kd3jjastn",movie_app_user_pool_id:"ap-southeast-1_yz7eb44ia",movie_app_www_distribution_id:"E14SG1HHD3N65C",movie_csv_processed_bucket_name:"movie-app-csv-processed-bucket",movie_csv_source_bucket_name:"movie-app-csv-source-bucket",movie_serverless_bucket_name:"movie-app-serverless-bucket",movie_similarity_table_name:"movie-similarity",movie_user_selection_name:"user-selection",public_subnets:["subnet-069ee4c1a5955765d","subnet-0ce7bc386fe60d549"]}};function go(){const e=o=>o.startsWith("_react")||o.startsWith("__react"),t=o=>Object.keys(o).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return kn()&&n().some(t)}function yo(){return ct()&&typeof Ut<"u"&&!!Object.keys(Ut).find(e=>e.includes("react"))}function Eo(){return Z()&&fe(window,"__VUE")}function Io(){return Me()&&fe(global,"__VUE")}var Ft={TERRAFORM_ENV:{fargate_security_group_id:"sg-01156858c7871ec6c",fargate_task_role_arn:"arn:aws:iam::410370150231:role/movie-app-FargateTaskRole",lambda_iam_role_arn:"arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",lambda_security_group_id:"sg-0735c702b1cd455e6",movie_app_bucket_www_name:"www.movieapp.paohenghsu.com",movie_app_glue_crawlers_name:{credits:"credits-csv",movies:"movies-csv",similarity:"similarity-csv"},movie_app_sns_arn:"arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",movie_app_user_pool_arn:"arn:aws:cognito-idp:ap-southeast-1:410370150231:userpool/ap-southeast-1_yz7eb44ia",movie_app_user_pool_client_id:"4t3f1n3ptj21omm15kd3jjastn",movie_app_user_pool_id:"ap-southeast-1_yz7eb44ia",movie_app_www_distribution_id:"E14SG1HHD3N65C",movie_csv_processed_bucket_name:"movie-app-csv-processed-bucket",movie_csv_source_bucket_name:"movie-app-csv-source-bucket",movie_serverless_bucket_name:"movie-app-serverless-bucket",movie_similarity_table_name:"movie-similarity",movie_user_selection_name:"user-selection",public_subnets:["subnet-069ee4c1a5955765d","subnet-0ce7bc386fe60d549"]}};function So(){return Z()&&fe(window,"__SVELTE")}function vo(){return ct()&&typeof Ft<"u"&&!!Object.keys(Ft).find(e=>e.includes("svelte"))}function wo(){return Z()&&window.next&&typeof window.next=="object"}function _o(){return Me()&&(fe(global,"__next")||fe(global,"__NEXT"))}function xo(){return Z()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function To(){return Me()&&typeof global.__NUXT_PATHS__<"u"}var Dt={TERRAFORM_ENV:{fargate_security_group_id:"sg-01156858c7871ec6c",fargate_task_role_arn:"arn:aws:iam::410370150231:role/movie-app-FargateTaskRole",lambda_iam_role_arn:"arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",lambda_security_group_id:"sg-0735c702b1cd455e6",movie_app_bucket_www_name:"www.movieapp.paohenghsu.com",movie_app_glue_crawlers_name:{credits:"credits-csv",movies:"movies-csv",similarity:"similarity-csv"},movie_app_sns_arn:"arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",movie_app_user_pool_arn:"arn:aws:cognito-idp:ap-southeast-1:410370150231:userpool/ap-southeast-1_yz7eb44ia",movie_app_user_pool_client_id:"4t3f1n3ptj21omm15kd3jjastn",movie_app_user_pool_id:"ap-southeast-1_yz7eb44ia",movie_app_www_distribution_id:"E14SG1HHD3N65C",movie_csv_processed_bucket_name:"movie-app-csv-processed-bucket",movie_csv_source_bucket_name:"movie-app-csv-source-bucket",movie_serverless_bucket_name:"movie-app-serverless-bucket",movie_similarity_table_name:"movie-similarity",movie_user_selection_name:"user-selection",public_subnets:["subnet-069ee4c1a5955765d","subnet-0ce7bc386fe60d549"]}};function Ro(){const e=!!(kn()&&document.querySelector("[ng-version]")),t=!!(Z()&&typeof window.ng<"u");return e||t}function Co(){var e;return ct()&&typeof Dt=="object"&&((e=Dt.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function bo(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function Ao(){return Me()&&typeof global.expo<"u"}function No(){return Z()}const Po=[{platform:S.Expo,detectionMethod:Ao},{platform:S.ReactNative,detectionMethod:bo},{platform:S.NextJs,detectionMethod:wo},{platform:S.Nuxt,detectionMethod:xo},{platform:S.Angular,detectionMethod:Ro},{platform:S.React,detectionMethod:go},{platform:S.VueJs,detectionMethod:Eo},{platform:S.Svelte,detectionMethod:So},{platform:S.WebUnknown,detectionMethod:No},{platform:S.NextJsSSR,detectionMethod:_o},{platform:S.NuxtSSR,detectionMethod:To},{platform:S.ReactSSR,detectionMethod:yo},{platform:S.VueJsSSR,detectionMethod:Io},{platform:S.AngularSSR,detectionMethod:Co},{platform:S.SvelteSSR,detectionMethod:vo}];function Uo(){var e;return((e=Po.find(t=>t.detectionMethod()))==null?void 0:e.platform)||S.ServerSideUnknown}const Fo=()=>typeof window<"u"&&typeof window.document<"u";function Ln(){return v.Auth.clearCredentials()}const D=(e,t,n,o)=>async(i,s)=>{const r={...o,...i},a=await r.endpointResolver(r,s),c=await t(s,a),u=await e(c,{...r});return n(u)},Kn={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Do={partitions:[Kn,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Bn=e=>{const{partitions:t}=Do;for(const{regions:n,outputs:o,regionRegex:i}of t){const s=new RegExp(i);if(n.includes(e)||s.test(e))return o.dnsSuffix}return Kn.outputs.dnsSuffix},Mo="6.3.1";let ue;const _e=[];let Ae=!1;const Oo=10,ko=10,Lo=1e3,qn=()=>{var e;if(!ue){if(ue=Uo(),Ae)for(;_e.length;)(e=_e.pop())==null||e();else _e.forEach(t=>{t()});Mt(S.ServerSideUnknown,Oo),Mt(S.WebUnknown,ko)}return ue},Ko=e=>{Ae||_e.push(e)};function Bo(){ue=void 0}function Mt(e,t){ue===e&&!Ae&&setTimeout(()=>{Bo(),Ae=!0,setTimeout(qn,Lo)},t)}const qo={},Ho=(e,t)=>{var n,o;return(o=(n=qo[e])==null?void 0:n[t])==null?void 0:o.additionalDetails},Vo="aws-amplify",$o=({category:e,action:t}={})=>{const n=[[Vo,Mo]];if(e&&n.push([e,t]),n.push(["framework",qn()]),e&&t){const o=Ho(e,t);o&&o.forEach(i=>{n.push(i)})}return n},Oe=e=>$o(e).map(([o,i])=>o&&i?`${o}/${i}`:o).join(" "),jo="cognito-identity",Wo=({region:e})=>({url:new Re(`https://cognito-identity.${e}.${Bn(e)}`)}),zo=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},Hn=bn(Pn,[zo]),ut={service:jo,endpointResolver:Wo,retryDecider:An(me),computeDelay:Nn,userAgentValue:Oe(),cache:"no-store"};Ko(()=>{ut.userAgentValue=Oe()});const Vn=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),$n=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),Go=(e,t)=>{const n=Vn("GetId"),o=JSON.stringify(e);return $n(t,n,o)},Yo=async e=>{if(e.statusCode>=300)throw await me(e);return{IdentityId:(await rt(e)).IdentityId,$metadata:Un(e)}},Zo=D(Hn,Go,Yo,ut),Jo=(e,t)=>{const n=Vn("GetCredentialsForIdentity"),o=JSON.stringify(e);return $n(t,n,o)},Xo=async e=>{if(e.statusCode>=300)throw await me(e);{const t=await rt(e);return{IdentityId:t.IdentityId,Credentials:Qo(t.Credentials),$metadata:Un(e)}}},Qo=({AccessKeyId:e,SecretKey:t,SessionToken:n,Expiration:o}={})=>({AccessKeyId:e,SecretKey:t,SessionToken:n,Expiration:o&&new Date(o*1e3)}),Ot=D(Hn,Jo,Xo,ut);class ye extends W{constructor(){super({name:be.PlatformNotSupported,message:"Function not supported on current platform"})}}class jn{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new ye;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new ye;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new ye;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new ye;this.storage.clear()}}class Wn{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const ei=()=>typeof window<"u"&&window.localStorage?window.localStorage:new Wn,ti=()=>typeof window<"u"&&window.sessionStorage?window.sessionStorage:new Wn;class ni extends jn{constructor(){super(ei())}}class oi extends jn{constructor(){super(ti())}}/*! js-cookie v3.0.5 | MIT */function Ee(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}var ii={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Je(e,t){function n(i,s,r){if(!(typeof document>"u")){r=Ee({},t,r),typeof r.expires=="number"&&(r.expires=new Date(Date.now()+r.expires*864e5)),r.expires&&(r.expires=r.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,r[c]!==!0&&(a+="="+r[c].split(";")[0]));return document.cookie=i+"="+e.write(s,i)+a}}function o(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],r={},a=0;a<s.length;a++){var c=s[a].split("="),u=c.slice(1).join("=");try{var d=decodeURIComponent(c[0]);if(r[d]=e.read(u,d),i===d)break}catch{}}return i?r[i]:r}}return Object.create({set:n,get:o,remove:function(i,s){n(i,"",Ee({},s,{expires:-1}))},withAttributes:function(i){return Je(this.converter,Ee({},this.attributes,i))},withConverter:function(i){return Je(Ee({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var Ie=Je(ii,{path:"/"});class kt{constructor(t={}){const{path:n,domain:o,expires:i,sameSite:s,secure:r}=t;if(this.domain=o,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?i:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?r:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!s||!["strict","lax","none"].includes(s))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(s==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=s}}async setItem(t,n){Ie.set(t,n,this.getData())}async getItem(t){return Ie.get(t)??null}async removeItem(t){Ie.remove(t,this.getData())}async clear(){const t=Ie.get(),n=Object.keys(t).map(o=>this.removeItem(o));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const z=new ni;new oi;const si=e=>{let t;return async(...n)=>t||(t=new Promise((o,i)=>{e(...n).then(s=>{o(s)}).catch(s=>{i(s)}).finally(()=>{t=void 0})}),t)},ri=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:o="",architecture:i="",fullVersionList:s=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),r=s.map(c=>`${c.brand}/${c.version}`).join(";");return[t,n,i,o,t,r].filter(c=>c).join(" ")};function ai(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const Ne={convert(e,{urlSafe:t}={urlSafe:!1}){const n=typeof e=="string"?e:ai(e),o=po()(n);return t?o.replace(/\+/g,"-").replace(/\//g,"_"):o}};function ci(){return fo().getRandomValues(new Uint32Array(1))[0]}function ui(e){const{words:t}=e,{sigBytes:n}=e,o=[];for(let i=0;i<n;i++){const s=t[i>>>2]>>>24-i%4*8&255;o.push((s>>>4).toString(16)),o.push((s&15).toString(16))}return o.join("")}class dt{constructor(t,n){this.words=[];let o=t;o=this.words=o||[],n!==void 0?this.sigBytes=n:this.sigBytes=o.length*4}random(t){const n=[];for(let o=0;o<t;o+=4)n.push(ci());return new dt(n,t)}toString(){return ui(this)}}class g extends W{constructor(t){super(t),this.constructor=g,Object.setPrototypeOf(this,g.prototype)}}function J(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new g({name:be.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const zn="cognito-idp",di=({region:e})=>{var i;const t=(i=v.getConfig().Auth)==null?void 0:i.Cognito,n=t==null?void 0:t.userPoolEndpoint,o=new Re(`https://${zn}.${e}.${Bn(e)}`);return{url:n?new Re(n):o}},li=()=>(e,t)=>async function(o){return o.headers["cache-control"]="no-store",e(o)},B=bn(Pn,[li]),q={service:zn,endpointResolver:di,retryDecider:An(me),computeDelay:Nn,userAgentValue:Oe(),cache:"no-store"},fi=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),pi=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),H=e=>(t,n)=>{const o=fi(e),i=JSON.stringify(t);return pi(n,o,i)},V=()=>async e=>{if(e.statusCode>=300){const t=await me(e);throw J(t),new g({name:t.name,message:t.message})}else return await rt(e)},ge=D(B,H("InitiateAuth"),V(),q),hi=D(B,H("RevokeToken"),V(),q),mi=D(B,H("SignUp"),V(),q),gi=D(B,H("ConfirmSignUp"),V(),q),lt=D(B,H("RespondToAuthChallenge"),V(),q),yi=D(B,H("ResendConfirmationCode"),V(),q),Ei=D(B,H("AssociateSoftwareToken"),V(),q),Ii=D(B,H("ConfirmDevice"),V(),q);var E;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"})(E||(E={}));const Si={[E.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[E.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[E.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[E.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[E.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[E.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[E.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[E.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[E.EmptySignInPassword]:{message:"password is required to signIn"},[E.EmptySignInUsername]:{message:"username is required to signIn"},[E.EmptySignUpPassword]:{message:"password is required to signUp"},[E.EmptySignUpUsername]:{message:"username is required to signUp"},[E.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[E.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS or TOTP",recoverySuggestion:"Try to pass TOTP or SMS as the challengeResponse"},[E.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[E.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[E.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var Lt;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(Lt||(Lt={}));var Pe;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(Pe||(Pe={}));function C(e,t){const{message:n,recoverySuggestion:o}=Si[t];if(!e)throw new g({name:t,message:n,recoverySuggestion:o})}function T(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new g({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function Xe(e){if(!e||!e.includes(":"))throw new g({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function Kt(e){return Object.entries(e).map(([t,n])=>({Name:t,Value:n}))}var Bt;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(Bt||(Bt={}));var qt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(qt||(qt={}));var Ht;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ht||(Ht={}));var Vt;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Vt||(Vt={}));var $t;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})($t||($t={}));var jt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(jt||(jt={}));var Wt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Wt||(Wt={}));var zt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(zt||(zt={}));var Gt;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(Gt||(Gt={}));var Yt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Yt||(Yt={}));var Zt;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(Zt||(Zt={}));var Jt;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(Jt||(Jt={}));var Xt;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Xt||(Xt={}));var Qt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(Qt||(Qt={}));var Ue;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ue||(Ue={}));var en;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(en||(en={}));var tn;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(tn||(tn={}));var nn;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(nn||(nn={}));var on;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(on||(on={}));var sn;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(sn||(sn={}));var rn;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(rn||(rn={}));var an;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(an||(an={}));var cn;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(cn||(cn={}));var un;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(un||(un={}));const ke="UserUnAuthenticatedException",vi="UserAlreadyAuthenticatedException",wi="DeviceMetadataNotFoundException",_i="InvalidRedirectException",xi=new g({name:_i,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."}),Ti="InvalidOriginException",Ri=new g({name:Ti,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),Ci="OAuthSignOutException",bi="TokenRefreshException",Ai="UnexpectedSignInInterruptionException";function Ni(e){if(!e||!e.accessToken)throw new g({name:ke,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function Pi(e){if(!e||!e.idToken)throw new g({name:ke,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Ui=new g({name:bi,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),Fi=new g({name:ke,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function Gn(e){if(Oi(e))throw Ui;if(!Mi(e))throw Fi}function Yn(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new g({name:wi,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const Di={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function Zn(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function Mi(e){return Zn(e)&&(e==null?void 0:e.refreshToken)}function Oi(e){return Zn(e)&&!(e!=null&&e.refreshToken)}const ki=async e=>{var a,c;const t=(a=e.getConfig().Auth)==null?void 0:a.Cognito;I(t);const n=await e.Auth.getTokens({forceRefresh:!1});Ni(n);const{"cognito:username":o,sub:i}=((c=n.idToken)==null?void 0:c.payload)??{},s={username:o,userId:i},r=Li(n);return r&&(s.signInDetails=r),s};function Li(e){return e==null?void 0:e.signInDetails}const ft=async()=>ki(v),$=(e,t)=>Oe({category:Ze.Auth,action:e,...t}),Ki=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return{...t.value};case"SET_CHALLENGE_NAME":return{...e,challengeName:t.value};case"SET_USERNAME":return{...e,username:t.value};case"SET_INITIAL_STATE":return Jn();default:return e}};function Jn(){return{username:void 0,challengeName:void 0,signInSession:void 0}}const Bi=e=>{let t=e(Jn(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},G=Bi(Ki);function Le(e){G.dispatch({type:"SET_SIGN_IN_STATE",value:e})}function K(){G.dispatch({type:"SET_INITIAL_STATE"})}const xe={convert(e){return new TextEncoder().encode(e)}};function p(e,t){e!=null&&this.fromString(e,t)}function x(){return new p(null,null)}let L;const qi=0xdeadbeefcafe,dn=(qi&16777215)===15715070;function Hi(e,t,n,o,i,s){for(;--s>=0;){const r=t*this[e++]+n[o]+i;i=Math.floor(r/67108864),n[o++]=r&67108863}return i}function Vi(e,t,n,o,i,s){const r=t&32767,a=t>>15;for(;--s>=0;){let c=this[e]&32767;const u=this[e++]>>15,d=a*c+u*r;c=r*c+((d&32767)<<15)+n[o]+(i&1073741823),i=(c>>>30)+(d>>>15)+a*u+(i>>>30),n[o++]=c&1073741823}return i}function $i(e,t,n,o,i,s){const r=t&16383,a=t>>14;for(;--s>=0;){let c=this[e]&16383;const u=this[e++]>>14,d=a*c+u*r;c=r*c+((d&16383)<<14)+n[o]+i,i=(c>>28)+(d>>14)+a*u,n[o++]=c&268435455}return i}const ln=typeof navigator<"u";ln&&dn&&navigator.appName==="Microsoft Internet Explorer"?(p.prototype.am=Vi,L=30):ln&&dn&&navigator.appName!=="Netscape"?(p.prototype.am=Hi,L=26):(p.prototype.am=$i,L=28);p.prototype.DB=L;p.prototype.DM=(1<<L)-1;p.prototype.DV=1<<L;const pt=52;p.prototype.FV=Math.pow(2,pt);p.prototype.F1=pt-L;p.prototype.F2=2*L-pt;const ji="0123456789abcdefghijklmnopqrstuvwxyz",Ke=[];let X,b;X=48;for(b=0;b<=9;++b)Ke[X++]=b;X=97;for(b=10;b<36;++b)Ke[X++]=b;X=65;for(b=10;b<36;++b)Ke[X++]=b;function fn(e){return ji.charAt(e)}function Wi(e,t){const n=Ke[e.charCodeAt(t)];return n??-1}function zi(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function Gi(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function ht(e){const t=x();return t.fromInt(e),t}function Yi(e,t){let n;if(t===16)n=4;else if(t===8)n=3;else if(t===2)n=1;else if(t===32)n=5;else if(t===4)n=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let o=e.length,i=!1,s=0;for(;--o>=0;){const r=Wi(e,o);if(r<0){e.charAt(o)==="-"&&(i=!0);continue}i=!1,s===0?this[this.t++]=r:s+n>this.DB?(this[this.t-1]|=(r&(1<<this.DB-s)-1)<<s,this[this.t++]=r>>this.DB-s):this[this.t-1]|=r<<s,s+=n,s>=this.DB&&(s-=this.DB)}this.clamp(),i&&p.ZERO.subTo(this,this)}function Zi(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function Ji(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const n=(1<<t)-1;let o,i=!1,s="",r=this.t,a=this.DB-r*this.DB%t;if(r-- >0)for(a<this.DB&&(o=this[r]>>a)>0&&(i=!0,s=fn(o));r>=0;)a<t?(o=(this[r]&(1<<a)-1)<<t-a,o|=this[--r]>>(a+=this.DB-t)):(o=this[r]>>(a-=t)&n,a<=0&&(a+=this.DB,--r)),o>0&&(i=!0),i&&(s+=fn(o));return i?s:"0"}function Xi(){const e=x();return p.ZERO.subTo(this,e),e}function Qi(){return this.s<0?this.negate():this}function es(e){let t=this.s-e.s;if(t!=0)return t;let n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this[n]-e[n])!=0)return t;return 0}function mt(e){let t=1,n;return(n=e>>>16)!==0&&(e=n,t+=16),(n=e>>8)!==0&&(e=n,t+=8),(n=e>>4)!==0&&(e=n,t+=4),(n=e>>2)!==0&&(e=n,t+=2),(n=e>>1)!==0&&(e=n,t+=1),t}function ts(){return this.t<=0?0:this.DB*(this.t-1)+mt(this[this.t-1]^this.s&this.DM)}function ns(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function os(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function is(e,t){const n=e%this.DB,o=this.DB-n,i=(1<<o)-1,s=Math.floor(e/this.DB);let r=this.s<<n&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>o|r,r=(this[a]&i)<<n;for(a=s-1;a>=0;--a)t[a]=0;t[s]=r,t.t=this.t+s+1,t.s=this.s,t.clamp()}function ss(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}const o=e%this.DB,i=this.DB-o,s=(1<<o)-1;t[0]=this[n]>>o;for(let r=n+1;r<this.t;++r)t[r-n-1]|=(this[r]&s)<<i,t[r-n]=this[r]>>o;o>0&&(t[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function rs(e,t){let n=0,o=0;const i=Math.min(e.t,this.t);for(;n<i;)o+=this[n]-e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o-=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o-=e[n],t[n++]=o&this.DM,o>>=this.DB;o-=e.s}t.s=o<0?-1:0,o<-1?t[n++]=this.DV+o:o>0&&(t[n++]=o),t.t=n,t.clamp()}function as(e,t){const n=this.abs(),o=e.abs();let i=n.t;for(t.t=i+o.t;--i>=0;)t[i]=0;for(i=0;i<o.t;++i)t[i+n.t]=n.am(0,o[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&p.ZERO.subTo(t,t)}function cs(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const o=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,o,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function us(e,t,n){const o=e.abs();if(o.t<=0)return;const i=this.abs();if(i.t<o.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n===null&&(n=x());const s=x(),r=this.s,a=e.s,c=this.DB-mt(o[o.t-1]);c>0?(o.lShiftTo(c,s),i.lShiftTo(c,n)):(o.copyTo(s),i.copyTo(n));const u=s.t,d=s[u-1];if(d===0)return;const f=d*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),l=this.FV/f,m=(1<<this.F1)/f,h=1<<this.F2;let y=n.t,_=y-u;const w=t===null?x():t;for(s.dlShiftTo(_,w),n.compareTo(w)>=0&&(n[n.t++]=1,n.subTo(w,n)),p.ONE.dlShiftTo(u,w),w.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--_>=0;){let k=n[--y]===d?this.DM:Math.floor(n[y]*l+(n[y-1]+h)*m);if((n[y]+=s.am(0,k,n,_,0,u))<k)for(s.dlShiftTo(_,w),n.subTo(w,n);n[y]<--k;)n.subTo(w,n)}t!==null&&(n.drShiftTo(u,t),r!==a&&p.ZERO.subTo(t,t)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),r<0&&p.ZERO.subTo(n,n)}function ds(e){const t=x();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(p.ZERO)>0&&e.subTo(t,t),t}function ls(){if(this.t<1)return 0;const e=this[0];if(!(e&1))return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function fs(e){return this.compareTo(e)===0}function ps(e,t){let n=0,o=0;const i=Math.min(e.t,this.t);for(;n<i;)o+=this[n]+e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o+=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o+=e[n],t[n++]=o&this.DM,o>>=this.DB;o+=e.s}t.s=o<0?-1:0,o>0?t[n++]=o:o<-1&&(t[n++]=this.DV+o),t.t=n,t.clamp()}function hs(e){const t=x();return this.addTo(e,t),t}function ms(e){const t=x();return this.subTo(e,t),t}function gs(e){const t=x();return this.multiplyTo(e,t),t}function ys(e){const t=x();return this.divRemTo(e,t,null),t}function Q(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Es(e){const t=x();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(p.ZERO)>0&&this.m.subTo(t,t),t}function Is(e){const t=x();return e.copyTo(t),this.reduce(t),t}function Ss(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=e[t]&32767;const o=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,o,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function vs(e,t){e.squareTo(t),this.reduce(t)}function ws(e,t,n){e.multiplyTo(t,n),this.reduce(n)}Q.prototype.convert=Es;Q.prototype.revert=Is;Q.prototype.reduce=Ss;Q.prototype.mulTo=ws;Q.prototype.sqrTo=vs;function _s(e,t,n){let o=e.bitLength(),i,s=ht(1);const r=new Q(t);if(o<=0)return s;o<18?i=1:o<48?i=3:o<144?i=4:o<768?i=5:i=6;const a=[];let c=3;const u=i-1,d=(1<<i)-1;if(a[1]=r.convert(this),i>1){const w=x();for(r.sqrTo(a[1],w);c<=d;)a[c]=x(),r.mulTo(w,a[c-2],a[c]),c+=2}let f=e.t-1,l,m=!0,h=x(),y;for(o=mt(e[f])-1;f>=0;){for(o>=u?l=e[f]>>o-u&d:(l=(e[f]&(1<<o+1)-1)<<u-o,f>0&&(l|=e[f-1]>>this.DB+o-u)),c=i;!(l&1);)l>>=1,--c;if((o-=c)<0&&(o+=this.DB,--f),m)a[l].copyTo(s),m=!1;else{for(;c>1;)r.sqrTo(s,h),r.sqrTo(h,s),c-=2;c>0?r.sqrTo(s,h):(y=s,s=h,h=y),r.mulTo(h,a[l],s)}for(;f>=0&&!(e[f]&1<<o);)r.sqrTo(s,h),y=s,s=h,h=y,--o<0&&(o=this.DB-1,--f)}const _=r.revert(s);return n(null,_),_}p.prototype.copyTo=zi;p.prototype.fromInt=Gi;p.prototype.fromString=Yi;p.prototype.clamp=Zi;p.prototype.dlShiftTo=ns;p.prototype.drShiftTo=os;p.prototype.lShiftTo=is;p.prototype.rShiftTo=ss;p.prototype.subTo=rs;p.prototype.multiplyTo=as;p.prototype.squareTo=cs;p.prototype.divRemTo=us;p.prototype.invDigit=ls;p.prototype.addTo=ps;p.prototype.toString=Ji;p.prototype.negate=Xi;p.prototype.abs=Qi;p.prototype.compareTo=es;p.prototype.bitLength=ts;p.prototype.mod=ds;p.prototype.equals=fs;p.prototype.add=hs;p.prototype.subtract=ms;p.prototype.multiply=gs;p.prototype.divide=ys;p.prototype.modPow=_s;p.ZERO=ht(0);p.ONE=ht(1);const xs=async({a:e,g:t,k:n,x:o,B:i,N:s,U:r})=>new Promise((a,c)=>{t.modPow(o,s,(u,d)=>{if(u){c(u);return}i.subtract(n.multiply(d)).modPow(e.add(r.multiply(o)),s,(f,l)=>{if(f){c(f);return}a(l.mod(s))})})}),Ts="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",Xn={},Qe={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Xn[e]=t,Qe[t]=e}const Y=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const o=e.slice(n,n+2).toLowerCase();if(o in Qe)t[n/2]=Qe[o];else throw new Error(`Cannot decode unrecognized sequence ${o} as hexadecimal`)}return t};var pe={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var et=function(e,t){return et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},et(e,t)};function Rs(e,t){et(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var tt=function(){return tt=Object.assign||function(t){for(var n,o=1,i=arguments.length;o<i;o++){n=arguments[o];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},tt.apply(this,arguments)};function Cs(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n}function bs(e,t,n,o){var i=arguments.length,s=i<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,n):o,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function As(e,t){return function(n,o){t(n,o,e)}}function Ns(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ps(e,t,n,o){function i(s){return s instanceof n?s:new n(function(r){r(s)})}return new(n||(n=Promise))(function(s,r){function a(d){try{u(o.next(d))}catch(f){r(f)}}function c(d){try{u(o.throw(d))}catch(f){r(f)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((o=o.apply(e,t||[])).next())})}function Us(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,i,s,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(d){return c([u,d])}}function c(u){if(o)throw new TypeError("Generator is already executing.");for(;n;)try{if(o=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(d){u=[6,d],i=0}finally{o=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Fs(e,t,n,o){o===void 0&&(o=n),e[o]=t[n]}function Ds(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function nt(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qn(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),i,s=[],r;try{for(;(t===void 0||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function Ms(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Qn(arguments[t]));return e}function Os(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],r=0,a=s.length;r<a;r++,i++)o[i]=s[r];return o}function he(e){return this instanceof he?(this.v=e,this):new he(e)}function ks(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(e,t||[]),i,s=[];return i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i;function r(l){o[l]&&(i[l]=function(m){return new Promise(function(h,y){s.push([l,m,h,y])>1||a(l,m)})})}function a(l,m){try{c(o[l](m))}catch(h){f(s[0][3],h)}}function c(l){l.value instanceof he?Promise.resolve(l.value.v).then(u,d):f(s[0][2],l)}function u(l){a("next",l)}function d(l){a("throw",l)}function f(l,m){l(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Ls(e){var t,n;return t={},o("next"),o("throw",function(i){throw i}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(i,s){t[i]=e[i]?function(r){return(n=!n)?{value:he(e[i](r)),done:i==="return"}:s?s(r):r}:s}}function Ks(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof nt=="function"?nt(e):e[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(s){n[s]=e[s]&&function(r){return new Promise(function(a,c){r=e[s](r),i(a,c,r.done,r.value)})}}function i(s,r,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},r)}}function Bs(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function qs(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function Hs(e){return e&&e.__esModule?e:{default:e}}function Vs(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function $s(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}const js=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return tt},__asyncDelegator:Ls,__asyncGenerator:ks,__asyncValues:Ks,__await:he,__awaiter:Ps,__classPrivateFieldGet:Vs,__classPrivateFieldSet:$s,__createBinding:Fs,__decorate:bs,__exportStar:Ds,__extends:Rs,__generator:Us,__importDefault:Hs,__importStar:qs,__makeTemplateObject:Bs,__metadata:Ns,__param:As,__read:Qn,__rest:Cs,__spread:Ms,__spreadArrays:Os,__values:nt},Symbol.toStringTag,{value:"Module"})),eo=Fn(js);var te={},R={},pn;function to(){return pn||(pn=1,Object.defineProperty(R,"__esModule",{value:!0}),R.MAX_HASHABLE_LENGTH=R.INIT=R.KEY=R.DIGEST_LENGTH=R.BLOCK_SIZE=void 0,R.BLOCK_SIZE=64,R.DIGEST_LENGTH=32,R.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),R.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],R.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1),R}var ne={},hn;function Ws(){if(hn)return ne;hn=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.RawSha256=void 0;var e=to(),t=function(){function n(){this.state=Int32Array.from(e.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return n.prototype.update=function(o){if(this.finished)throw new Error("Attempted to update an already finished hash.");var i=0,s=o.byteLength;if(this.bytesHashed+=s,this.bytesHashed*8>e.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;s>0;)this.buffer[this.bufferLength++]=o[i++],s--,this.bufferLength===e.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},n.prototype.digest=function(){if(!this.finished){var o=this.bytesHashed*8,i=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),s=this.bufferLength;if(i.setUint8(this.bufferLength++,128),s%e.BLOCK_SIZE>=e.BLOCK_SIZE-8){for(var r=this.bufferLength;r<e.BLOCK_SIZE;r++)i.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(var r=this.bufferLength;r<e.BLOCK_SIZE-8;r++)i.setUint8(r,0);i.setUint32(e.BLOCK_SIZE-8,Math.floor(o/4294967296),!0),i.setUint32(e.BLOCK_SIZE-4,o),this.hashBuffer(),this.finished=!0}for(var a=new Uint8Array(e.DIGEST_LENGTH),r=0;r<8;r++)a[r*4]=this.state[r]>>>24&255,a[r*4+1]=this.state[r]>>>16&255,a[r*4+2]=this.state[r]>>>8&255,a[r*4+3]=this.state[r]>>>0&255;return a},n.prototype.hashBuffer=function(){for(var o=this,i=o.buffer,s=o.state,r=s[0],a=s[1],c=s[2],u=s[3],d=s[4],f=s[5],l=s[6],m=s[7],h=0;h<e.BLOCK_SIZE;h++){if(h<16)this.temp[h]=(i[h*4]&255)<<24|(i[h*4+1]&255)<<16|(i[h*4+2]&255)<<8|i[h*4+3]&255;else{var y=this.temp[h-2],_=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10;y=this.temp[h-15];var w=(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3;this.temp[h]=(_+this.temp[h-7]|0)+(w+this.temp[h-16]|0)}var k=(((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&f^~d&l)|0)+(m+(e.KEY[h]+this.temp[h]|0)|0)|0,ee=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&a^r&c^a&c)|0;m=l,l=f,f=d,d=u+k|0,u=c,c=a,a=r,r=k+ee|0}s[0]+=r,s[1]+=a,s[2]+=c,s[3]+=u,s[4]+=d,s[5]+=f,s[6]+=l,s[7]+=m},n}();return ne.RawSha256=t,ne}var Ye={},oe={};const zs=e=>{const t=[];for(let n=0,o=e.length;n<o;n++){const i=e.charCodeAt(n);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192,i&63|128);else if(n+1<e.length&&(i&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320){const s=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023);t.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else t.push(i>>12|224,i>>6&63|128,i&63|128)}return Uint8Array.from(t)},Gs=e=>{let t="";for(let n=0,o=e.length;n<o;n++){const i=e[n];if(i<128)t+=String.fromCharCode(i);else if(192<=i&&i<224){const s=e[++n];t+=String.fromCharCode((i&31)<<6|s&63)}else if(240<=i&&i<365){const r="%"+[i,e[++n],e[++n],e[++n]].map(a=>a.toString(16)).join("%");t+=decodeURIComponent(r)}else t+=String.fromCharCode((i&15)<<12|(e[++n]&63)<<6|e[++n]&63)}return t};function Ys(e){return new TextEncoder().encode(e)}function Zs(e){return new TextDecoder("utf-8").decode(e)}const Js=e=>typeof TextEncoder=="function"?Ys(e):zs(e),Xs=e=>typeof TextDecoder=="function"?Zs(e):Gs(e),Qs=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:Js,toUtf8:Xs},Symbol.toStringTag,{value:"Module"})),er=Fn(Qs);var mn;function tr(){if(mn)return oe;mn=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.convertToBuffer=void 0;var e=er,t=typeof Buffer<"u"&&Buffer.from?function(o){return Buffer.from(o,"utf8")}:e.fromUtf8;function n(o){return o instanceof Uint8Array?o:typeof o=="string"?t(o):ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(o)}return oe.convertToBuffer=n,oe}var ie={},gn;function nr(){if(gn)return ie;gn=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.isEmptyData=void 0;function e(t){return typeof t=="string"?t.length===0:t.byteLength===0}return ie.isEmptyData=e,ie}var se={},yn;function or(){if(yn)return se;yn=1,Object.defineProperty(se,"__esModule",{value:!0}),se.numToUint8=void 0;function e(t){return new Uint8Array([(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255])}return se.numToUint8=e,se}var re={},En;function ir(){if(En)return re;En=1,Object.defineProperty(re,"__esModule",{value:!0}),re.uint32ArrayFrom=void 0;function e(t){if(!Uint32Array.from){for(var n=new Uint32Array(t.length),o=0;o<t.length;)n[o]=t[o],o+=1;return n}return Uint32Array.from(t)}return re.uint32ArrayFrom=e,re}var In;function sr(){return In||(In=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uint32ArrayFrom=e.numToUint8=e.isEmptyData=e.convertToBuffer=void 0;var t=tr();Object.defineProperty(e,"convertToBuffer",{enumerable:!0,get:function(){return t.convertToBuffer}});var n=nr();Object.defineProperty(e,"isEmptyData",{enumerable:!0,get:function(){return n.isEmptyData}});var o=or();Object.defineProperty(e,"numToUint8",{enumerable:!0,get:function(){return o.numToUint8}});var i=ir();Object.defineProperty(e,"uint32ArrayFrom",{enumerable:!0,get:function(){return i.uint32ArrayFrom}})}(Ye)),Ye}var Sn;function rr(){if(Sn)return te;Sn=1,Object.defineProperty(te,"__esModule",{value:!0}),te.Sha256=void 0;var e=eo,t=to(),n=Ws(),o=sr(),i=function(){function r(a){this.secret=a,this.hash=new n.RawSha256,this.reset()}return r.prototype.update=function(a){if(!((0,o.isEmptyData)(a)||this.error))try{this.hash.update((0,o.convertToBuffer)(a))}catch(c){this.error=c}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new n.RawSha256,this.secret){this.outer=new n.RawSha256;var a=s(this.secret),c=new Uint8Array(t.BLOCK_SIZE);c.set(a);for(var u=0;u<t.BLOCK_SIZE;u++)a[u]^=54,c[u]^=92;this.hash.update(a),this.outer.update(c);for(var u=0;u<a.byteLength;u++)a[u]=0}},r}();te.Sha256=i;function s(r){var a=(0,o.convertToBuffer)(r);if(a.byteLength>t.BLOCK_SIZE){var c=new n.RawSha256;c.update(a),a=c.digest()}var u=new Uint8Array(t.BLOCK_SIZE);return u.set(a),u}return te}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=eo;t.__exportStar(rr(),e)})(pe);const gt=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Xn[e[n]];return t},ot=e=>{const t=new pe.Sha256;t.update(e);const n=t.digestSync(),o=gt(n);return new Array(64-o.length).join("0")+o},Te=e=>ot(Y(e)),ar=/^[89a-f]/i,M=e=>{if(!(e instanceof p))throw new Error("Not a BigInteger");const t=e.compareTo(p.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=ar.test(n)?`00${n}`:n,t){const o=n.split("").map(s=>{const r=~parseInt(s,16)&15;return"0123456789ABCDEF".charAt(r)}).join("");n=new p(o,16).add(p.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},cr=({A:e,B:t})=>{const n=new p(Te(M(e)+M(t)),16);if(n.equals(p.ZERO))throw new Error("U cannot be zero.");return n},ur=(e,t,n)=>{const o=new pe.Sha256(t);o.update(e);const i=o.digestSync(),s=new pe.Sha256(i);return s.update(n),s.digestSync().slice(0,16)},yt=e=>{const t=new dt().random(e).toString();return Y(t)},dr=()=>Ne.convert(yt(40));class lr{constructor({userPoolName:t,a:n,g:o,A:i,N:s}){this.encoder=xe,this.userPoolName=t,this.a=n,this.g=o,this.A=i,this.N=s,this.k=new p(Te(`${M(s)}${M(o)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new g({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new g({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new g({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,n){this.randomPassword=dr();const o=`${t}${n}:${this.randomPassword}`,i=ot(o),s=gt(yt(16));return this.saltToHashDevices=M(new p(s,16)),new Promise((r,a)=>{this.g.modPow(new p(Te(this.saltToHashDevices+i),16),this.N,(c,u)=>{if(c){a(c);return}this.verifierDevices=M(u),r()})})}async getPasswordAuthenticationKey({username:t,password:n,serverBValue:o,salt:i}){if(o.mod(this.N).equals(p.ZERO))throw new Error("B cannot be zero.");const s=cr({A:this.A,B:o}),r=`${this.userPoolName}${t}:${n}`,a=ot(r),c=new p(Te(M(i)+a),16),u=await xs({a:this.a,g:this.g,k:this.k,x:c,B:o,N:this.N,U:s}),d=this.encoder.convert("Caldera Derived Key"),f=this.encoder.convert(""),l=new Uint8Array(d.byteLength+f.byteLength);return l.set(d,0),l.set(f,d.byteLength),ur(Y(M(u)),Y(M(s)),l)}}const fr=async({a:e,g:t,N:n})=>new Promise((o,i)=>{t.modPow(e,n,(s,r)=>{if(s){i(s);return}if(r.mod(n).equals(p.ZERO)){i(new Error("Illegal parameter. A mod N cannot be 0."));return}o(r)})}),Be=async e=>{const t=new p(Ts,16),n=new p("2",16),o=pr(),i=await fr({a:o,g:n,N:t});return new lr({userPoolName:e,a:o,g:n,A:i,N:t})},pr=()=>{const e=gt(yt(128));return new p(e,16)},hr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],mr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],no=()=>{const e=new Date,t=mr[e.getUTCDay()],n=hr[e.getUTCMonth()],o=e.getUTCDate();let i=e.getUTCHours();i<10&&(i=`0${i}`);let s=e.getUTCMinutes();s<10&&(s=`0${s}`);let r=e.getUTCSeconds();r<10&&(r=`0${r}`);const a=e.getUTCFullYear();return`${t} ${n} ${o} ${i}:${s}:${r} UTC ${a}`},oo=({userPoolName:e,username:t,challengeParameters:n,dateNow:o,hkdf:i})=>{const s=xe.convert(e),r=xe.convert(t),a=gr(n.SECRET_BLOCK),c=xe.convert(o),u=new Uint8Array(s.byteLength+r.byteLength+a.byteLength+c.byteLength);u.set(s,0),u.set(r,s.byteLength),u.set(a,s.byteLength+r.byteLength),u.set(c,s.byteLength+r.byteLength+a.byteLength);const d=new pe.Sha256(i);d.update(u);const f=d.digestSync();return Ne.convert(f)},gr=e=>{const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),o=Mn.convert(n),i=new Uint8Array(o.length);for(let s=0;s<o.length;++s)i[s]=o.charCodeAt(s);return i};function O({username:e,userPoolId:t,userPoolClientId:n}){if(typeof window>"u")return;const o=window.AmazonCognitoAdvancedSecurityData;if(typeof o>"u")return;const i=o.getData(e,t,n);return i?{EncodedData:i}:{}}const vn="userAttributes.";async function yr(e,t,n,o,i){var m,h;const{userPoolClientId:s,userPoolId:r}=o,a={USERNAME:e,PASSWORD:t},c=await i.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);const u=O({username:e,userPoolId:r,userPoolClientId:s}),d={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:a,ClientMetadata:n,ClientId:s,UserContextData:u},f=await ge({region:T(r),userAgentValue:$(U.SignIn)},d),l=((m=f.ChallengeParameters)==null?void 0:m.USERNAME)??((h=f.ChallengeParameters)==null?void 0:h.USER_ID_FOR_SRP)??e;return je(l),f.ChallengeName==="DEVICE_SRP_AUTH"?Et({username:l,config:o,clientMetadata:n,session:f.Session,tokenOrchestrator:i}):f}async function Er(e,t,n,o,i){const{userPoolId:s,userPoolClientId:r}=o,a=(s==null?void 0:s.split("_")[1])||"",c=await Be(a),u={USERNAME:e,SRP_A:c.A.toString(16)},d=O({username:e,userPoolId:s,userPoolClientId:r}),f={AuthFlow:"USER_SRP_AUTH",AuthParameters:u,ClientMetadata:n,ClientId:r,UserContextData:d},l=await ge({region:T(s),userAgentValue:$(U.SignIn)},f),{ChallengeParameters:m,Session:h}=l,y=(m==null?void 0:m.USERNAME)??e;return je(y),$e(io,[t,m,n,h,c,o,i],y,i)}async function Ir(e,t,n,o){var l;const{userPoolClientId:i,userPoolId:s}=n,r={USERNAME:e},a=await o.getDeviceMetadata(e);a&&a.deviceKey&&(r.DEVICE_KEY=a.deviceKey);const c=O({username:e,userPoolId:s,userPoolClientId:i}),u={AuthFlow:"CUSTOM_AUTH",AuthParameters:r,ClientMetadata:t,ClientId:i,UserContextData:c},d=await ge({region:T(s),userAgentValue:$(U.SignIn)},u),f=((l=d.ChallengeParameters)==null?void 0:l.USERNAME)??e;return je(f),d.ChallengeName==="DEVICE_SRP_AUTH"?Et({username:f,config:n,clientMetadata:t,session:d.Session,tokenOrchestrator:o}):d}async function Sr(e,t,n,o,i){I(o);const{userPoolId:s,userPoolClientId:r}=o,a=(s==null?void 0:s.split("_")[1])||"",c=await Be(a),u={USERNAME:e,SRP_A:c.A.toString(16),CHALLENGE_NAME:"SRP_A"},d=O({username:e,userPoolId:s,userPoolClientId:r}),f={AuthFlow:"CUSTOM_AUTH",AuthParameters:u,ClientMetadata:n,ClientId:r,UserContextData:d},{ChallengeParameters:l,Session:m}=await ge({region:T(s),userAgentValue:$(U.SignIn)},f),h=(l==null?void 0:l.USERNAME)??e;return je(h),$e(io,[t,l,n,m,c,o,i],h,i)}async function Et({username:e,config:t,clientMetadata:n,session:o,tokenOrchestrator:i}){const{userPoolId:s}=t,r=t.userPoolClientId,a=await(i==null?void 0:i.getDeviceMetadata(e));Yn(a);const c=await Be(a.deviceGroupKey),u={USERNAME:e,SRP_A:c.A.toString(16),DEVICE_KEY:a.deviceKey},d={ChallengeName:"DEVICE_SRP_AUTH",ClientId:r,ChallengeResponses:u,ClientMetadata:n,Session:o},{ChallengeParameters:f,Session:l}=await lt({region:T(s)},d);return vr(e,f,n,l,c,t,i)}async function vr(e,t,n,o,i,{userPoolId:s,userPoolClientId:r},a){const c=await(a==null?void 0:a.getDeviceMetadata(e));Yn(c);const u=new p(t==null?void 0:t.SRP_B,16),d=new p(t==null?void 0:t.SALT,16),{deviceKey:f}=c,{deviceGroupKey:l}=c,m=await i.getPasswordAuthenticationKey({username:c.deviceKey,password:c.randomPassword,serverBValue:u,salt:d}),h=no(),y={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:h,PASSWORD_CLAIM_SIGNATURE:oo({username:f,userPoolName:l,challengeParameters:t,dateNow:h,hkdf:m}),DEVICE_KEY:f},_=O({username:e,userPoolId:s,userPoolClientId:r}),w={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:r,ChallengeResponses:y,Session:o,ClientMetadata:n,UserContextData:_};return lt({region:T(s)},w)}async function io(e,t,n,o,i,s,r){const{userPoolId:a,userPoolClientId:c}=s,u=(a==null?void 0:a.split("_")[1])||"",d=new p(t==null?void 0:t.SRP_B,16),f=new p(t==null?void 0:t.SALT,16),l=t==null?void 0:t.USER_ID_FOR_SRP;if(!l)throw new g({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const m=await i.getPasswordAuthenticationKey({username:l,password:e,serverBValue:d,salt:f}),h=no(),y={USERNAME:l,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:h,PASSWORD_CLAIM_SIGNATURE:oo({username:l,userPoolName:u,challengeParameters:t,dateNow:h,hkdf:m})},_=await r.getDeviceMetadata(l);_&&_.deviceKey&&(y.DEVICE_KEY=_.deviceKey);const w=O({username:l,userPoolId:a,userPoolClientId:c}),k={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:y,ClientMetadata:n,Session:o,ClientId:c,UserContextData:w},ee=await lt({region:T(a)},k);return ee.ChallengeName==="DEVICE_SRP_AUTH"?Et({username:l,config:s,clientMetadata:n,session:ee.Session,tokenOrchestrator:r}):ee}async function qe(e){var i;const{challengeName:t,challengeParameters:n}=e,o=(i=v.getConfig().Auth)==null?void 0:i.Cognito;switch(I(o),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:s,username:r}=G.getState();if(!Tr(n,"TOTP"))throw new g({name:Pe.SignInException,message:`Cannot initiate MFA setup from available types: ${it(st(n.MFAS_CAN_SETUP))}`});const{Session:a,SecretCode:c}=await Ei({region:T(o.userPoolId)},{Session:s});return G.dispatch({type:"SET_SIGN_IN_SESSION",value:a}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:wr(c,r)}}}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:_r(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:it(st(n.MFAS_CAN_CHOOSE))}};case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}}}throw new g({name:Pe.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function wr(e,t){return{sharedSecret:e,getSetupUri:(n,o)=>{const i=`otpauth://totp/${n}:${o??t}?secret=${e}&issuer=${n}`;return new Re(i)}}}function He(e){if(e===Ue.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===Ue.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function _r(e){return e?JSON.parse(e).map(n=>n.includes(vn)?n.replace(vn,""):n):[]}function xr(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP"}function it(e){if(e)return e.map(xr).filter(Boolean)}function st(e){return e?JSON.parse(e):[]}function Tr(e,t){const{MFAS_CAN_SETUP:n}=e,o=it(st(n));return o?o.includes(t):!1}async function Rr(){let e;try{e=await ft()}catch{}if(e&&e.userId&&e.username)throw new g({name:vi,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}async function Ve(e,t,n){if(!t)return;const o=e.split("_")[1]||"",i=await Be(o),s=t==null?void 0:t.DeviceKey,r=t==null?void 0:t.DeviceGroupKey;try{await i.generateHashDevice(r??"",s??"")}catch{return}const a={Salt:Ne.convert(Y(i.getSaltToHashDevices())),PasswordVerifier:Ne.convert(Y(i.getVerifierDevices()))},c=i.getRandomPassword();try{return await Ii({region:T(e)},{AccessToken:n,DeviceName:await ri(),DeviceKey:t==null?void 0:t.DeviceKey,DeviceSecretVerifierConfig:a}),{deviceKey:s,deviceGroupKey:r,randomPassword:c}}catch{return}}async function $e(e,t,n,o){try{return await e(...t)}catch(i){if(i instanceof g&&i.name==="ResourceNotFoundException"&&i.message.includes("Device does not exist."))return await o.clearDeviceMetadata(n),e(...t);throw i}}function je(e){const{dispatch:t}=G;t({type:"SET_USERNAME",value:e})}function We(e){return G.getState().username??e}const Cr=async({tokens:e,authConfig:t,username:n})=>{var l,m;I(t==null?void 0:t.Cognito);const o=T(t.Cognito.userPoolId);Gn(e);const i=e.refreshToken,s={REFRESH_TOKEN:i};(l=e.deviceMetadata)!=null&&l.deviceKey&&(s.DEVICE_KEY=e.deviceMetadata.deviceKey);const r=O({username:n,userPoolId:t.Cognito.userPoolId,userPoolClientId:t.Cognito.userPoolClientId}),{AuthenticationResult:a}=await ge({region:o},{ClientId:(m=t==null?void 0:t.Cognito)==null?void 0:m.userPoolClientId,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:s,UserContextData:r}),c=j((a==null?void 0:a.AccessToken)??""),u=a!=null&&a.IdToken?j(a.IdToken):void 0,{iat:d}=c.payload;if(!d)throw new g({name:"iatNotFoundException",message:"iat not found in access token"});const f=d*1e3-new Date().getTime();return{accessToken:c,idToken:u,clockDrift:f,refreshToken:i,username:n}},br=si(Cr),Ar={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails"};var Fe;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(Fe||(Fe={}));const Nr={[Fe.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},Pr=Dn(Nr);class Ur{constructor(){this.name="CognitoIdentityServiceProvider"}getKeyValueStorage(){if(!this.keyValueStorage)throw new g({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new g({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const o=j(n),i=await this.getKeyValueStorage().getItem(t.idToken),s=i?j(i):void 0,r=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,a=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(a),u=await this.getKeyValueStorage().getItem(t.signInDetails),d={accessToken:o,idToken:s,refreshToken:r,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return u&&(d.signInDetails=JSON.parse(u)),d}catch{return null}}async storeTokens(t){Pr(t!==void 0,Fe.InvalidAuthTokens),await this.clearTokens();const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const o=await this.getAuthKeys();await this.getKeyValueStorage().setItem(o.accessToken,t.accessToken.toString()),t.idToken&&await this.getKeyValueStorage().setItem(o.idToken,t.idToken.toString()),t.refreshToken&&await this.getKeyValueStorage().setItem(o.refreshToken,t.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(o.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(o.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(o.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails&&await this.getKeyValueStorage().setItem(o.signInDetails,JSON.stringify(t.signInDetails)),await this.getKeyValueStorage().setItem(o.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey())])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),o=await this.getKeyValueStorage().getItem(n.deviceKey),i=await this.getKeyValueStorage().getItem(n.deviceGroupKey),s=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return s&&i&&o?{deviceKey:o,deviceGroupKey:i,randomPassword:s}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){var o;I((o=this.authConfig)==null?void 0:o.Cognito);const n=t??await this.getLastAuthUser();return Fr(this.name,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){var n;I((n=this.authConfig)==null?void 0:n.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${this.name}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}}const Fr=(e,t)=>It(Ar)(`${e}`,t);function It(e){const t=Object.values({...e});return(n,o)=>t.reduce((i,s)=>({...i,[s]:`${n}.${o}.${s}`}),{})}const wn="amplify-signin-with-hostedUI",A="CognitoIdentityServiceProvider";class so{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){I(this.cognitoConfig);const t=N(A,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){I(this.cognitoConfig);const t=N(A,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(wn),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){I(this.cognitoConfig);const t=N(A,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){I(this.cognitoConfig);const n=N(A,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){I(this.cognitoConfig);const t=N(A,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){I(this.cognitoConfig);const n=N(A,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){I(this.cognitoConfig);const t=N(A,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){I(this.cognitoConfig);const n=N(A,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var s;I(this.cognitoConfig);const t=N(A,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(wn),[o,i]=((s=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:s.split(","))??[];return{isOAuthSignIn:o==="true"||n==="true",preferPrivateSession:i==="true"}}async storeOAuthSignIn(t,n=!1){I(this.cognitoConfig);const o=N(A,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(o.oauthSignIn,`${t},${n}`)}}const N=(e,t)=>It(Di)(e,t),_n=new so(z);class Dr{constructor(){this.waitForInflightOAuth=Fo()?async()=>{if(await _n.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){_n.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new g({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new g({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){var r,a,c,u,d;let n;try{I((r=this.authConfig)==null?void 0:r.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const o=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const i=!!(n!=null&&n.idToken)&&vt({expiresAt:(((c=(a=n.idToken)==null?void 0:a.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:n.clockDrift??0}),s=vt({expiresAt:(((d=(u=n.accessToken)==null?void 0:u.payload)==null?void 0:d.exp)??0)*1e3,clockDrift:n.clockDrift??0});return(t!=null&&t.forceRefresh||i||s)&&(n=await this.refreshTokens({tokens:n,username:o}),n===null)?null:{accessToken:n==null?void 0:n.accessToken,idToken:n==null?void 0:n.idToken,signInDetails:n==null?void 0:n.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:o}=t,i=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return i.signInDetails=o,await this.setTokens({tokens:i}),de.dispatch("auth",{event:"tokenRefresh"},"Auth",le),i}catch(o){return this.handleErrors(o)}}handleErrors(t){if(J(t),t.message!=="Network error"&&this.clearTokens(),de.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",le),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}}class Mr{constructor(){this.authTokenStore=new Ur,this.authTokenStore.setKeyValueStorage(z),this.tokenOrchestrator=new Dr,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(br)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const ae=new Mr,{tokenOrchestrator:F}=ae;async function ze(e){if(e.AccessToken){const t=j(e.AccessToken),n=(t.payload.iat||0)*1e3,o=new Date().getTime(),i=n>0?n-o:0;let s,r,a;e.RefreshToken&&(r=e.RefreshToken),e.IdToken&&(s=j(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(a=e.NewDeviceMetadata);const c={accessToken:t,idToken:s,refreshToken:r,clockDrift:i,deviceMetadata:a,username:e.username};e!=null&&e.signInDetails&&(c.signInDetails=e.signInDetails),await F.setTokens({tokens:c})}else throw new W({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const Or="Unable to get user session following successful sign-in.",Ge=async()=>{try{de.dispatch("auth",{event:"signedIn",data:await ft()},"Auth",le)}catch(e){throw e.name===ke?new g({name:Ai,message:Or,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};async function kr(e){var a;const t=(a=v.getConfig().Auth)==null?void 0:a.Cognito;I(t);const{username:n,password:o,options:i}=e,s={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},r=i==null?void 0:i.clientMetadata;C(!!n,E.EmptySignInUsername),C(!o,E.CustomAuthSignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:f}=await $e(Ir,[n,r,t,F],n,F),l=We(n);return Le({signInSession:f,username:l,challengeName:c,signInDetails:s}),d?(K(),await ze({username:l,...d,NewDeviceMetadata:await Ve(t.userPoolId,d.NewDeviceMetadata,d.AccessToken),signInDetails:s}),await Ge(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):qe({challengeName:c,challengeParameters:u})}catch(c){K(),J(c);const u=He(c.name);if(u)return u;throw c}}async function Lr(e){var a;const{username:t,password:n,options:o}=e,i={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},s=(a=v.getConfig().Auth)==null?void 0:a.Cognito;I(s);const r=o==null?void 0:o.clientMetadata;C(!!t,E.EmptySignInUsername),C(!!n,E.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:f}=await Sr(t,n,r,s,F),l=We(t);return Le({signInSession:f,username:l,challengeName:c,signInDetails:i}),d?(await ze({username:l,...d,NewDeviceMetadata:await Ve(s.userPoolId,d.NewDeviceMetadata,d.AccessToken),signInDetails:i}),K(),await Ge(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):qe({challengeName:c,challengeParameters:u})}catch(c){K(),J(c);const u=He(c.name);if(u)return u;throw c}}async function xn(e){var r,a;const{username:t,password:n}=e,o=(r=v.getConfig().Auth)==null?void 0:r.Cognito,i={loginId:t,authFlowType:"USER_SRP_AUTH"};I(o);const s=(a=e.options)==null?void 0:a.clientMetadata;C(!!t,E.EmptySignInUsername),C(!!n,E.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:f}=await Er(t,n,s,o,F),l=We(t);return Le({signInSession:f,username:l,challengeName:c,signInDetails:i}),d?(K(),await ze({username:l,...d,NewDeviceMetadata:await Ve(o.userPoolId,d.NewDeviceMetadata,d.AccessToken),signInDetails:i}),await Ge(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):qe({challengeName:c,challengeParameters:u})}catch(c){K(),J(c);const u=He(c.name);if(u)return u;throw c}}async function Kr(e){var a;const{username:t,password:n,options:o}=e,i=(a=v.getConfig().Auth)==null?void 0:a.Cognito,s={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};I(i);const r=o==null?void 0:o.clientMetadata;C(!!t,E.EmptySignInUsername),C(!!n,E.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:f}=await $e(yr,[t,n,r,i,F],t,F),l=We(t);return Le({signInSession:f,username:l,challengeName:c,signInDetails:s}),d?(await ze({...d,username:l,NewDeviceMetadata:await Ve(i.userPoolId,d.NewDeviceMetadata,d.AccessToken),signInDetails:s}),K(),await Ge(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):qe({challengeName:c,challengeParameters:u})}catch(c){K(),J(c);const u=He(c.name);if(u)return u;throw c}}async function Br(e){var n;const t=(n=e.options)==null?void 0:n.authFlowType;switch(await Rr(),t){case"USER_SRP_AUTH":return xn(e);case"USER_PASSWORD_AUTH":return Kr(e);case"CUSTOM_WITHOUT_SRP":return kr(e);case"CUSTOM_WITH_SRP":return Lr(e);default:return xn(e)}}const qr=3*60*1e3;function Hr(e){const t=Ce.listen("auth-internal",async({payload:o})=>{switch(o.event){case"confirmSignUp":{const i=o.data;i!=null&&i.isSignUpComplete&&(Ce.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),n=setTimeout(()=>{t(),St(!1),clearTimeout(n)},qr)}let ro=!1,ao;function co(e){ao=e}function Vr(e){return ao===e}function ce(){return ro}function St(e){e===!1&&co(void 0),ro=e}function Se(e){return!!e.UserConfirmed}async function $r(e){var m;const{username:t,password:n,options:o}=e,i=(m=v.getConfig().Auth)==null?void 0:m.Cognito,s=(i==null?void 0:i.signUpVerificationMethod)??"code",{clientMetadata:r,validationData:a,autoSignIn:c}=e.options??{};I(i),C(!!t,E.EmptySignUpUsername),C(!!n,E.EmptySignUpPassword);const u=typeof c!="boolean"?c:void 0;u==null||u.authFlowType,(u||c===!0)&&(co(t),St(!0));const d=await mi({region:T(i.userPoolId),userAgentValue:$(U.SignUp)},{Username:t,Password:n,UserAttributes:(o==null?void 0:o.userAttributes)&&Kt(o==null?void 0:o.userAttributes),ClientMetadata:r,ValidationData:a&&Kt(a),ClientId:i.userPoolClientId}),{UserSub:f,CodeDeliveryDetails:l}=d;if(Se(d)&&ce())return{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:f};if(Se(d)&&!ce())return{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:f};if(!Se(d)&&ce()&&s==="code")Hr();else if(!Se(d)&&ce()&&s==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:{deliveryMedium:l==null?void 0:l.DeliveryMedium,destination:l==null?void 0:l.Destination,attributeName:l==null?void 0:l.AttributeName}},userId:f};return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:{deliveryMedium:l==null?void 0:l.DeliveryMedium,destination:l==null?void 0:l.Destination,attributeName:l==null?void 0:l.AttributeName}},userId:f}}async function jr(e){var f,l;const{username:t}=e;C(!!t,E.EmptySignUpUsername);const n=(f=v.getConfig().Auth)==null?void 0:f.Cognito;I(n);const{userPoolClientId:o,userPoolId:i}=n,s=(l=e.options)==null?void 0:l.clientMetadata,r=O({username:t,userPoolId:i,userPoolClientId:o}),{CodeDeliveryDetails:a}=await yi({region:T(n.userPoolId),userAgentValue:$(U.ResendSignUpCode)},{Username:t,ClientMetadata:s,ClientId:n.userPoolClientId,UserContextData:r}),{DeliveryMedium:c,AttributeName:u,Destination:d}={...a};return{destination:d,deliveryMedium:c,attributeName:u||void 0}}async function Wr(e){var u;const{username:t,confirmationCode:n,options:o}=e,i=(u=v.getConfig().Auth)==null?void 0:u.Cognito;I(i);const{userPoolId:s,userPoolClientId:r}=i,a=o==null?void 0:o.clientMetadata;C(!!t,E.EmptyConfirmSignUpUsername),C(!!n,E.EmptyConfirmSignUpCode);const c=O({username:t,userPoolId:s,userPoolClientId:r});return await gi({region:T(i.userPoolId),userAgentValue:$(U.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:a,ForceAliasCreation:o==null?void 0:o.forceAliasCreation,ClientId:i.userPoolClientId,UserContextData:c}),new Promise((d,f)=>{try{const l={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}};if(!ce()||!Vr(t)){d(l);return}const m=Ce.listen("auth-internal",({payload:h})=>{switch(h.event){case"autoSignIn":d({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),St(!1),m()}});Ce.dispatch("auth-internal",{event:"confirmSignUp",data:l})}catch(l){f(l)}})}function zr(e){const t=(e==null?void 0:e.find(Gr))??(e==null?void 0:e.find(Yr)),n=(e==null?void 0:e.find(Jr))??(e==null?void 0:e.find(Zr));if(t)return t;throw n?Ri:xi}const Gr=e=>e.startsWith(String(window.location.origin+window.location.pathname)),Yr=e=>e.includes(String(window.location.hostname)),Zr=e=>e.startsWith("http://"),Jr=e=>e.startsWith("https://"),Xr=async e=>{window!=null&&window.location&&(window.location.href=e.replace("http://","https://"))},Qr=async e=>{await e.clearOAuthData(),F.clearTokens(),await Ln(),de.dispatch("auth",{event:"signedOut"},"Auth",le)},ea=async(e,t=!1)=>{On(e);const{loginWith:n,userPoolClientId:o}=e,{domain:i,redirectSignOut:s}=n.oauth,r=zr(s),a=`https://${i}/logout?${Object.entries({client_id:o,logout_uri:encodeURIComponent(r)}).map(([c,u])=>`${c}=${u}`).join("&")}`;return Xr(a)},ta=async(e,t)=>{const{isOAuthSignIn:n}=await t.loadOAuthSignIn();if(await Qr(t),n)return ea(e)},na=new De("Auth");async function oa(e){var o;const t=(o=v.getConfig().Auth)==null?void 0:o.Cognito;I(t),await ia(t);let n;try{On(t),n=!0}catch{n=!1}if(n){const i=new so(z);i.setAuthConfig(t);const{type:s}=await ta(t,i)??{};if(s==="error")throw new g({name:Ci,message:"An error occurred when attempting to log out from OAuth provider."})}else F.clearTokens(),await Ln(),de.dispatch("auth",{event:"signedOut"},"Auth",le)}async function ia(e){try{const t=await F.getTokenStore().loadTokens();Gn(t),sa(t.accessToken)&&await hi({region:T(e.userPoolId),userAgentValue:$(U.SignOut)},{ClientId:e.userPoolClientId,Token:t.refreshToken})}catch{na.debug("Client signOut error caught but will proceed with token removal")}}const sa=e=>{var t;return!!((t=e==null?void 0:e.payload)!=null&&t.origin_jti)},ra={identityId:"identityId"},aa=new De("DefaultIdentityIdStore");class ca{setAuthConfig(t){we(t.Cognito),this.authConfig=t,this._authKeys=ua("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this.keyValueStorage=t}async loadIdentityId(){var t;we((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const n=await this.keyValueStorage.getItem(this._authKeys.identityId);return n?{id:n,type:"guest"}:null}}catch(n){return aa.log("Error getting stored IdentityId.",n),null}}async storeIdentityId(t){var n;we((n=this.authConfig)==null?void 0:n.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0):(this._primaryIdentityId=t.id,this.keyValueStorage.removeItem(this._authKeys.identityId))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const ua=(e,t)=>It(ra)(`com.amplify.${e}`,t);function uo(e){const t=j(e).payload.iss,n={};if(!t)throw new g({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const o=t.replace(/(^\w+:|^)\/\//,"");return n[o]=e,n}const da=new De("CognitoIdentityIdProvider");async function la({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});let o=await n.loadIdentityId();if(e){if(o&&o.type==="primary")return o.id;{const i=e.idToken?uo(e.idToken.toString()):{},s=await Tn(i,t);o&&o.id===s&&da.debug(`The guest identity ${o.id} has become the primary identity.`),o={id:s,type:"primary"}}}else{if(o&&o.type==="guest")return o.id;o={id:await Tn({},t),type:"guest"}}return n.storeIdentityId(o),o.id}async function Tn(e,t){const n=t==null?void 0:t.identityPoolId,o=Xe(n),i=(await Zo({region:o},{IdentityPoolId:n,Logins:e})).IdentityId;if(!i)throw new g({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return i}const ve=new De("CognitoCredentialsProvider"),Rn=50*60*1e3;class fa{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){ve.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){ve.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:o}=t,{authConfig:i}=t;try{we(i==null?void 0:i.Cognito)}catch{return}if(!n&&!i.Cognito.allowGuestAccess)return;const{forceRefresh:s}=t,r=this.hasTokenChanged(o),a=await la({tokens:o,authConfig:i.Cognito,identityIdStore:this._identityIdStore});return(s||r)&&this.clearCredentials(),n?(Pi(o),this.credsForOIDCTokens(i.Cognito,o,a)):this.getGuestCredentials(a,i.Cognito)}async getGuestCredentials(t,n){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return ve.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const o=Xe(n.identityPoolId),i=await Ot({region:o},{IdentityId:t});if(i.Credentials&&i.Credentials.AccessKeyId&&i.Credentials.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+Rn;const s={credentials:{accessKeyId:i.Credentials.AccessKeyId,secretAccessKey:i.Credentials.SecretKey,sessionToken:i.Credentials.SessionToken,expiration:i.Credentials.Expiration},identityId:t},r=i.IdentityId;return r&&(s.identityId=r,this._identityIdStore.storeIdentityId({id:r,type:"guest"})),this._credentialsAndIdentityId={...s,isAuthenticatedCreds:!1},s}else throw new g({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,o){var a;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return ve.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const i=n.idToken?uo(n.idToken.toString()):{},s=Xe(t.identityPoolId),r=await Ot({region:s},{IdentityId:o,Logins:i});if(r.Credentials&&r.Credentials.AccessKeyId&&r.Credentials.SecretKey){const c={credentials:{accessKeyId:r.Credentials.AccessKeyId,secretAccessKey:r.Credentials.SecretKey,sessionToken:r.Credentials.SessionToken,expiration:r.Credentials.Expiration},identityId:o};this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!0,associatedIdToken:(a=n.idToken)==null?void 0:a.toString()},this._nextCredentialsRefresh=new Date().getTime()+Rn;const u=r.IdentityId;return u&&(c.identityId=u,this._identityIdStore.storeIdentityId({id:u,type:"primary"})),c}else throw new g({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var n,o;return!!t&&!!((n=this._credentialsAndIdentityId)!=null&&n.associatedIdToken)&&((o=t.idToken)==null?void 0:o.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const pa=new fa(new ca(z)),ha={configure(e,t){const n=lo(e);if(!n.Auth){v.configure(n,t);return}if(t!=null&&t.Auth){v.configure(n,t);return}if(!v.libraryOptions.Auth){ae.setAuthConfig(n.Auth),ae.setKeyValueStorage(t!=null&&t.ssr?new kt({sameSite:"lax"}):z),v.configure(n,{...t,Auth:{tokenProvider:ae,credentialsProvider:pa}});return}if(t){t.ssr!==void 0&&ae.setKeyValueStorage(t.ssr?new kt({sameSite:"lax"}):z),v.configure(n,{Auth:v.libraryOptions.Auth,...t});return}v.configure(n)},getConfig(){return v.getConfig()}};var ma={TERRAFORM_ENV:{fargate_security_group_id:"sg-01156858c7871ec6c",fargate_task_role_arn:"arn:aws:iam::410370150231:role/movie-app-FargateTaskRole",lambda_iam_role_arn:"arn:aws:iam::410370150231:role/movie-app-LambdaExecuteRole",lambda_security_group_id:"sg-0735c702b1cd455e6",movie_app_bucket_www_name:"www.movieapp.paohenghsu.com",movie_app_glue_crawlers_name:{credits:"credits-csv",movies:"movies-csv",similarity:"similarity-csv"},movie_app_sns_arn:"arn:aws:sns:ap-southeast-1:410370150231:movie-app-s3-triggered-event",movie_app_user_pool_arn:"arn:aws:cognito-idp:ap-southeast-1:410370150231:userpool/ap-southeast-1_yz7eb44ia",movie_app_user_pool_client_id:"4t3f1n3ptj21omm15kd3jjastn",movie_app_user_pool_id:"ap-southeast-1_yz7eb44ia",movie_app_www_distribution_id:"E14SG1HHD3N65C",movie_csv_processed_bucket_name:"movie-app-csv-processed-bucket",movie_csv_source_bucket_name:"movie-app-csv-source-bucket",movie_serverless_bucket_name:"movie-app-serverless-bucket",movie_similarity_table_name:"movie-similarity",movie_user_selection_name:"user-selection",public_subnets:["subnet-069ee4c1a5955765d","subnet-0ce7bc386fe60d549"]}};const Cn=ma.TERRAFORM_ENV;ha.configure({Auth:{Cognito:{userPoolClientId:Cn.movie_app_user_pool_client_id,userPoolId:Cn.movie_app_user_pool_id}},API:{REST:{movieApi:{endpoint:"https://api.movieapp.paohenghsu.com",region:"ap-southeast-1"}}}});const Ea=async()=>{try{return await ft()}catch(e){alert(e),console.error(e)}},Ia=async({username:e,password:t})=>{try{return await Br({username:e,password:t})}catch(n){alert(n),console.error(n)}},Sa=async({username:e,password:t})=>{try{return await $r({username:e,password:t})}catch(n){alert(n),console.error(n)}},va=async()=>{try{await oa(),window.addEventListener("unload",function(){localStorage.clear()})}catch(e){alert(e),console.error(e)}},wa=async({username:e,confirmationCode:t})=>{try{return await Wr({username:e,confirmationCode:t})}catch(n){alert(n),console.error(n)}},_a=async({username:e})=>{try{return await jr({username:e})}catch(t){alert(t),console.error(t)}};export{Sa as a,va as b,wa as c,Ea as g,_a as r,Ia as s};
